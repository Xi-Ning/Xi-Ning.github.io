<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1 为什么要关心Java 8 | 熙宁的笔记</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="熙宁的笔记">
    <link rel="preload" href="/assets/css/0.styles.a214eddf.css" as="style"><link rel="preload" href="/assets/js/app.7ea158cc.js" as="script"><link rel="preload" href="/assets/js/2.167078e5.js" as="script"><link rel="preload" href="/assets/js/19.d7dae1a8.js" as="script"><link rel="preload" href="/assets/js/7.9c9ec0c0.js" as="script"><link rel="prefetch" href="/assets/js/10.a1772af3.js"><link rel="prefetch" href="/assets/js/11.1e675497.js"><link rel="prefetch" href="/assets/js/12.79bef4f7.js"><link rel="prefetch" href="/assets/js/13.6e9ad29d.js"><link rel="prefetch" href="/assets/js/14.7c41145a.js"><link rel="prefetch" href="/assets/js/15.fd904f12.js"><link rel="prefetch" href="/assets/js/16.059f8460.js"><link rel="prefetch" href="/assets/js/17.f056884e.js"><link rel="prefetch" href="/assets/js/18.d2d48b45.js"><link rel="prefetch" href="/assets/js/20.9da1840e.js"><link rel="prefetch" href="/assets/js/21.56908442.js"><link rel="prefetch" href="/assets/js/22.b8756be9.js"><link rel="prefetch" href="/assets/js/23.dd40b66d.js"><link rel="prefetch" href="/assets/js/24.9c20d5ab.js"><link rel="prefetch" href="/assets/js/25.d4c3be91.js"><link rel="prefetch" href="/assets/js/26.7f1a9bfe.js"><link rel="prefetch" href="/assets/js/27.e1735a18.js"><link rel="prefetch" href="/assets/js/28.2dc573d4.js"><link rel="prefetch" href="/assets/js/29.c6a0adcd.js"><link rel="prefetch" href="/assets/js/3.01a6a1b4.js"><link rel="prefetch" href="/assets/js/30.328e32f5.js"><link rel="prefetch" href="/assets/js/31.19020bf9.js"><link rel="prefetch" href="/assets/js/32.fc3853f5.js"><link rel="prefetch" href="/assets/js/33.65a7c4ae.js"><link rel="prefetch" href="/assets/js/34.74edf802.js"><link rel="prefetch" href="/assets/js/35.6e623b09.js"><link rel="prefetch" href="/assets/js/36.5e0c3a84.js"><link rel="prefetch" href="/assets/js/37.9b23ded0.js"><link rel="prefetch" href="/assets/js/38.ecb8852f.js"><link rel="prefetch" href="/assets/js/39.5cced95f.js"><link rel="prefetch" href="/assets/js/4.0fdf8adc.js"><link rel="prefetch" href="/assets/js/40.9b689566.js"><link rel="prefetch" href="/assets/js/41.e0947889.js"><link rel="prefetch" href="/assets/js/42.20e95b2f.js"><link rel="prefetch" href="/assets/js/5.ef0f248a.js"><link rel="prefetch" href="/assets/js/6.2622a0f7.js"><link rel="prefetch" href="/assets/js/8.b1d96fa7.js"><link rel="prefetch" href="/assets/js/9.a220f369.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a214eddf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo128.png" alt="熙宁的笔记" class="logo"> <span class="site-name can-hide">熙宁的笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语法区" class="dropdown-title"><span class="title">语法区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ★ 数据库 ★
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/devlang/db/oracle/grammar/DDO-G01-start_with.html" class="nav-link">
  Oracle
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="扫盲区" class="dropdown-title"><span class="title">扫盲区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/concept/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/concept/network/" class="nav-link">
  计算机网络
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实践区" class="dropdown-title"><span class="title">实践区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ★ 综合复盘 ★
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/project/EP-001-high_concurrency.html" class="nav-link">
  某高并发互联网项目
</a></li></ul></li><li class="dropdown-item"><h4>
          ★ 数据库 ★
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/db/oracle/basic/EDO-B01-exp_empty.html" class="nav-link">
  Oracle
</a></li></ul></li><li class="dropdown-item"><h4>
          
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/css/solution/EC-S01-collapse_chrome.html" class="nav-link">
  CSS
</a></li></ul></li><li class="dropdown-item"><h4>
          
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/other/" class="nav-link">
  其它
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专项区" class="dropdown-title"><span class="title">专项区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/special/java8_in_action/SJIA-001-why_java8.html" class="nav-link router-link-exact-active router-link-active">
  Java 8 实战
</a></li><li class="dropdown-item"><!----> <a href="/special/effective_java/SEJ-001-create_destroy_objects.html" class="nav-link">
  Effective Java 第2版
</a></li></ul></div></div><div class="nav-item"><a href="/readingnotes/" class="nav-link">
  阅读区
</a></div><div class="nav-item"><a href="/wordlist/" class="nav-link">
  单词表
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语法区" class="dropdown-title"><span class="title">语法区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ★ 数据库 ★
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/devlang/db/oracle/grammar/DDO-G01-start_with.html" class="nav-link">
  Oracle
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="扫盲区" class="dropdown-title"><span class="title">扫盲区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/concept/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/concept/network/" class="nav-link">
  计算机网络
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实践区" class="dropdown-title"><span class="title">实践区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ★ 综合复盘 ★
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/project/EP-001-high_concurrency.html" class="nav-link">
  某高并发互联网项目
</a></li></ul></li><li class="dropdown-item"><h4>
          ★ 数据库 ★
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/db/oracle/basic/EDO-B01-exp_empty.html" class="nav-link">
  Oracle
</a></li></ul></li><li class="dropdown-item"><h4>
          
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/css/solution/EC-S01-collapse_chrome.html" class="nav-link">
  CSS
</a></li></ul></li><li class="dropdown-item"><h4>
          
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/experience/other/" class="nav-link">
  其它
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专项区" class="dropdown-title"><span class="title">专项区</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/special/java8_in_action/SJIA-001-why_java8.html" class="nav-link router-link-exact-active router-link-active">
  Java 8 实战
</a></li><li class="dropdown-item"><!----> <a href="/special/effective_java/SEJ-001-create_destroy_objects.html" class="nav-link">
  Effective Java 第2版
</a></li></ul></div></div><div class="nav-item"><a href="/readingnotes/" class="nav-link">
  阅读区
</a></div><div class="nav-item"><a href="/wordlist/" class="nav-link">
  单词表
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java 8 实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/special/java8_in_action/SJIA-001-why_java8.html" class="active sidebar-link">1 为什么要关心Java 8</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-1-java怎么还在变" class="sidebar-link">1.1 Java怎么还在变</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-1-1-编程语言生态系统" class="sidebar-link">1.1.1 编程语言生态系统</a></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-1-2-三个编程概念以及背后的思想" class="sidebar-link">1.1.2 三个编程概念以及背后的思想</a></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-1-3-java需要演变" class="sidebar-link">1.1.3 Java需要演变</a></li></ul></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-2-java中的函数" class="sidebar-link">1.2 Java中的函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-2-1-让方法成为一等公民" class="sidebar-link">1.2.1 让方法成为一等公民</a></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-2-2-方法引用" class="sidebar-link">1.2.2 方法引用</a></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-2-3-lambda" class="sidebar-link">1.2.3 Lambda</a></li></ul></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-3-流" class="sidebar-link">1.3 流</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-3-1-简化集合处理" class="sidebar-link">1.3.1 简化集合处理</a></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-3-2-利用多核" class="sidebar-link">1.3.2 利用多核</a></li></ul></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-4-默认方法" class="sidebar-link">1.4 默认方法</a></li><li class="sidebar-sub-header"><a href="/special/java8_in_action/SJIA-001-why_java8.html#_1-5-函数式编程的一些思想" class="sidebar-link">1.5 函数式编程的一些思想</a></li></ul></li><li><a href="/special/java8_in_action/SJIA-002-behavior_parameterization.html" class="sidebar-link">2 通过行为参数化传递代码</a></li><li><a href="/special/java8_in_action/SJIA-003-lambda.html" class="sidebar-link">3 Lambda表达式</a></li><li><a href="/special/java8_in_action/SJIA-004-stream.html" class="sidebar-link">4 引入流</a></li><li><a href="/special/java8_in_action/SJIA-005-use_stream.html" class="sidebar-link">5 使用流</a></li><li><a href="/special/java8_in_action/SJIA-006-collectors.html" class="sidebar-link">6 用流收集数据</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-为什么要关心java-8"><a href="#_1-为什么要关心java-8" class="header-anchor">#</a> 1 为什么要关心Java 8</h1> <div class="seal-box" data-v-77f8f7a4><div data-v-77f8f7a4><!----> <div class="head" data-v-77f8f7a4>读书笔记</div> <div data-v-77f8f7a4><span class="ico ico-book" data-v-77f8f7a4>  书   名  ： Java 8 实战</span></div> <div data-v-77f8f7a4><span class="ico ico-author" data-v-77f8f7a4>  作   者  ： （英）Raoul-Gabriel Urma（意）Mario Fusco（英）Alan Myscroft</span></div> <div data-v-77f8f7a4><span class="ico ico-translator" data-v-77f8f7a4>  译   者  ： 陆明刚，劳佳</span></div> <div data-v-77f8f7a4><span class="ico ico-publisher" data-v-77f8f7a4> 出 版 社 ： 人民邮电出版社</span></div> <div data-v-77f8f7a4><span class="ico ico-calendar" data-v-77f8f7a4>出版时间： 2016.04</span></div> <div data-v-77f8f7a4><span class="ico ico-date" data-v-77f8f7a4>创建时间：</span> <span class="info" data-v-77f8f7a4>2021.11.27</span></div> <div data-v-77f8f7a4><span class="ico ico-refresh" data-v-77f8f7a4>最后更新：</span> <span class="info" data-v-77f8f7a4>2021.11.29</span></div> <!----> <!----> <!----> <div class="foot" data-v-77f8f7a4>竢实扬华 · 自强不息</div></div></div> <blockquote><p>Java8发布时间：2014年3月</p></blockquote> <h2 id="_1-1-java怎么还在变"><a href="#_1-1-java怎么还在变" class="header-anchor">#</a> 1.1 Java怎么还在变</h2> <h3 id="_1-1-1-编程语言生态系统"><a href="#_1-1-1-编程语言生态系统" class="header-anchor">#</a> 1.1.1 编程语言生态系统</h3> <p>编程语言就像生态系统一样，新的语言会出现，旧语言则被替代，除非它们不断演变。</p> <div class="custom-block tip"><p class="custom-block-title">备注</p> <p>在现实中没有完美的通用语言，某些语言只是更合适某些方面。</p> <p>比如：C和C++仍然是构建操作系统和各种嵌入式系统的流行工具，因为它们编出的程序尽管安全性不佳，但运行时占用资源少。</p></div> <p>编程语言生态系统的气候正在变化，程序员越来越多的要处理所谓的<span class="stress">大数据</span>，并希望利用多核计算机（Java此前并不支持并行处理）或计算集群来有效的处理。</p> <p>新语言不断出现，虽然为了一个功能而改用新的语言和工具链往往太过痛苦，但因为新语言迅速适应了气候变化而越来越受欢迎，新语言最终会取代现有的语言，除非后者演变得够快，能跟得上节奏。</p> <p>Java 8对于程序员的主要好处在于它提供了更多的编程工具和概念，能以更快，更重要的是能以更简洁、更易于维护的方式解决新的或现有的编程问题。</p> <h3 id="_1-1-2-三个编程概念以及背后的思想"><a href="#_1-1-2-三个编程概念以及背后的思想" class="header-anchor">#</a> 1.1.2 三个编程概念以及背后的思想</h3> <h4 id="_1-1-2-1-流处理"><a href="#_1-1-2-1-流处理" class="header-anchor">#</a> 1.1.2.1 流处理</h4> <p>流是一系列数据项，一次只生成一项。</p> <p>程序可以从输入流中一个一个读取数据库，然后以统一的方式将数据项写入输出流。一个程序的输出流很可能是另一个程序的输入流。</p> <div class="custom-block tip"><p class="custom-block-title">举例</p> <p>Unix或Linux命令可以通过管道（|）将多个程序连接在一起：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> file1 file2 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">&quot;[A-Z]&quot;</span> <span class="token string">&quot;[a-z]&quot;</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">tail</span> -3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <p>基于这种思想，Java 8在<code>java.util.stream</code>中添加了一个Stream API，可以在更高的抽象层次上写程序了，思路变成了把这样的流变成那样的流，而不是一次只处理一个项目。</p> <p>另一个好处是，Java 8可以透明地把输入的不相关部分拿到几个CPU内核上去分别执行Stream操作流水线。</p> <h4 id="_1-1-2-2-用行为参数化把代码传递给方法"><a href="#_1-1-2-2-用行为参数化把代码传递给方法" class="header-anchor">#</a> 1.1.2.2 用行为参数化把代码传递给方法</h4> <p>在Java 8之前，使用<code>sort</code>方法进行排序，需要创建一个<code>Comparator</code>对象传递给<code>sort</code>方法，而不能直接传递排序的逻辑代码，这种做法不仅仅有点啰嗦，而且让“重复使用现有行为”的思想变得不那么清楚了。</p> <p>Java 8中增加的了通过API来传递代码的能力，也就是行为参数化。Stram API就是构建在通过传递代码使操作行为实现参数化的思想上的。</p> <h4 id="_1-1-2-3-并行与共享的可变数据"><a href="#_1-1-2-3-并行与共享的可变数据" class="header-anchor">#</a> 1.1.2.3 并行与共享的可变数据</h4> <p>Java 8的流处理是并行的，它要求传递给流方法的行为必须能够同时对不同的输入安全的执行，也就是代码不能访问共享的可变数据。</p> <blockquote><p>满足上述要求的函数也被称为“纯函数”、或“无副作用函数”，或“无状态函数”。</p></blockquote> <p>Java 8的流实现并行比Java现有的线程API更容易。</p> <div class="custom-block warning"><p class="custom-block-title">synchronized</p> <p>尽管可以使用<code>synchronized</code>来打破“不能有共享的可变数据”这一规则，但这相当于是在和整个体系作对，因为它使所有围绕这一规则做出的优化都是去意义了。</p> <p>在多个处理器内核之间使用<code>synchronized</code>，其代价往往比预期要大得多，因为同步迫使代码按照顺序执行，而这与并行处理的宗旨相悖。</p></div> <p>没有共享的可变数据，以及将方法和函数即代码传递给其他方法的能力，这两个要点是函数式编程范式的基石。</p> <h3 id="_1-1-3-java需要演变"><a href="#_1-1-3-java需要演变" class="header-anchor">#</a> 1.1.3 Java需要演变</h3> <p>Java 8中的主要变化反映了它开始远离侧重改变现有值的经典面向对象思想，而向函数式编程领域转变。</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>极端来说，传统的面向对象编程和函数式可能看起来是冲突的，但我们的理念是获得两种编程范式中最好的东西。</p></div> <p>语言需要不断改进以跟进硬件的更新或满足程序员的期待。</p> <h2 id="_1-2-java中的函数"><a href="#_1-2-java中的函数" class="header-anchor">#</a> 1.2 Java中的函数</h2> <h3 id="_1-2-1-让方法成为一等公民"><a href="#_1-2-1-让方法成为一等公民" class="header-anchor">#</a> 1.2.1 让方法成为一等公民</h3> <p>编程语言的整个目的就在于操作值，因此值被称作为一等公民。编程语言中的其他结构在程序执行期间不能传递，因而是二等公民。</p> <p>让方法等概念作为一等公民可以扩充程序员的工具库，从而让编程变得更容易。</p> <p>Java 8允许方法作为值，这也构成了其他若干Java 8新功能的基础。</p> <h3 id="_1-2-2-方法引用"><a href="#_1-2-2-方法引用" class="header-anchor">#</a> 1.2.2 方法引用</h3> <p>筛选一个目录中的所有隐藏文件，在Java 8之前只能这样实现：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">File</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hiddenFiles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">isHidden</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Java 8中可以使用<span class="stress">方法引用</span>（即把这个方法作为值，语法为<code>::</code>），将代码重构：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">File</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hiddenFiles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token class-name">File</span><span class="token operator">::</span><span class="token function">isHidden</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_1-2-3-lambda"><a href="#_1-2-3-lambda" class="header-anchor">#</a> 1.2.3 Lambda</h3> <p>除了允许命名函数成为一等公民外，Java 8还体现了更为广义的将函数作为值的思想，包括<span class="stress">Lambda（或匿名函数）</span>。</p> <p>比如将入参x加1返回的函数，可以做一个MyMathUtils工具类，在里面定义一个add1方法，然后通过<code>MyMathUtils::add1</code>将方法作为值传递，但这样不够简洁，且很多时候没有很方便的类和方法可用（起名也是件令人头疼的事情），此时可以使用Lambda：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> x <span class="token operator">+</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_1-3-流"><a href="#_1-3-流" class="header-anchor">#</a> 1.3 流</h2> <p>Stream API解决了两个问题：集合处理时的套路和晦涩，以及难以利用多核。</p> <p>这样设计的原因是：有许多反复出现的数据处理模式，且这些操作常常可以并行化。</p> <h3 id="_1-3-1-简化集合处理"><a href="#_1-3-1-简化集合处理" class="header-anchor">#</a> 1.3.1 简化集合处理</h3> <p>几乎每一个Java应用都会制造和处理集合，但集合使用起来并不总是那么理想。比如，需要从交易列表中筛选出大额交易并按货币分组，需要写一大堆套路化的代码来实现数据的处理，集合的遍历以及多个嵌套的控制流指令，让人很难一眼看出来这一大段代码是做什么的。</p> <p>Java 8的Stream API解决了这个问题：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Currency</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Transaction</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> transactionsByCurrencies <span class="token operator">=</span> 
    transactions<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Transaction</span> t<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> t<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">Transaction</span><span class="token operator">::</span><span class="token function">getCurrency</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">外部迭代与内部迭代</p> <p>使用集合时，需要循环一个个去迭代元素、处理元素，这种数据迭代的方法称为外部迭代。</p> <p>Stream API则不用关心循环的事情，数据处理完全在库内部进行，这种思想称为内部迭代。</p></div> <h3 id="_1-3-2-利用多核"><a href="#_1-3-2-利用多核" class="header-anchor">#</a> 1.3.2 利用多核</h3> <p>经典的Java程序只能利用计算机的一个核，其他核的处理能力都浪费了。</p> <p>多线程并非易事，通过多线程代码来利用并行，线程很可能会同时访问并更新共享变量，如果没有协调好（传统上利用<code>synchronized</code>关键字进行协调，但误用很可能导致很多难以察觉的错误），数据可能会被以外改变。</p> <p>Java 8基于Stream的并行提倡很少使用<code>synchronized</code>的函数式编程风格，Stream关注数据分块而不是协调访问。Stream利用多核的例子如下图：</p> <p><img src="/assets/img/SJIA-001-01.06ae338a.jpg" alt=""></p> <blockquote><p>集合Collection主要是为了存储和访问数据，而Stream则主要用于描述对数据的计算。</p></blockquote> <p>筛选一个集合最快的方法常常是将集合转换为Stream，进行并行处理，然后再转换回集合。</p> <h2 id="_1-4-默认方法"><a href="#_1-4-默认方法" class="header-anchor">#</a> 1.4 默认方法</h2> <p>在加入新功能时，Java 8的设计者发现了一个现实的问题：现有的接口也在改进，如果更新了一个接口，那么所有实现它的类也都意味着要进行更新，这简直是逻辑灾难。</p> <p>如何改变已发布的接口而不破坏已有的实现呢？默认方法（使用<code>default</code>关键字）解决了这个问题。</p> <p>Java 8的接口如今可以包含实现类没有提供实现的方法签名了，缺失的方法主体随接口提供（也就是接口中有默认实现），而不需由实现类提供。</p> <div class="custom-block danger"><p class="custom-block-title">多继承</p> <p>一个类可以实现多个接口，而接口中含有默认实现，这意味着Java有了某种形式的多继承。</p></div> <h2 id="_1-5-函数式编程的一些思想"><a href="#_1-5-函数式编程的一些思想" class="header-anchor">#</a> 1.5 函数式编程的一些思想</h2> <ul><li><p>将方法和Lambda作为一等公民</p></li> <li><p>在没有可变共享状态时，函数或方法可以有效、安全地并行执行</p></li> <li><p>通过使用更多的描述性数据类型来避免null</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">Optional&lt;T&gt;</p> <p>Java 8的<code>Optional&lt;T&gt;</code>是一个容器对象，可以包含或不包含一个值，内部有方法来明确处理值不存在的情况，也就避免了空指针异常。</p> <p>换句话说，它使用类型系统，允许表明我们知道一个变量可能没有值。</p></div> <ul><li>匹配模式</li></ul> <div class="custom-block tip"><p class="custom-block-title">匹配模式</p> <p>模式匹配可以比<code>if-then-else</code>更简明的表达编程思想。</p> <p>也可以使用多态和方法重载来替代<code>if-then-else</code>，但与模式匹配相比，哪种方式更适合，仍有一些争论。</p> <p>模式匹配可以看做是<code>switch</code>的扩展形式，Java 8对其支持并不完全。</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/special/java8_in_action/SJIA-002-behavior_parameterization.html">
        2 通过行为参数化传递代码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7ea158cc.js" defer></script><script src="/assets/js/2.167078e5.js" defer></script><script src="/assets/js/19.d7dae1a8.js" defer></script><script src="/assets/js/7.9c9ec0c0.js" defer></script>
  </body>
</html>
